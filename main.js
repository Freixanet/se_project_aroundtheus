!function(){"use strict";var e={960:function(e,t,s){e.exports=s.p+"563265067da28dd4dc29.jpg"},656:function(e,t,s){e.exports=s.p+"2568685201fe7f0f52ba.jpg"},822:function(e,t,s){e.exports=s.p+"e8e2e03a0c4914605924.jpg"},328:function(e,t,s){e.exports=s.p+"b7539ef6565749e91e45.jpg"},994:function(e,t,s){e.exports=s.p+"bff45a6885472eb58ca2.jpg"},339:function(e,t,s){e.exports=s.p+"c7b4a4a877366d68d05f.jpg"}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,s),r.exports}s.m=e,s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.b=document.baseURI||self.location.href,function(){const e=[{name:"Lago di Braies",link:new URL(s(656),s.b)},{name:"Vanoise National Park",link:new URL(s(994),s.b)},{name:"Lake Louise",link:new URL(s(822),s.b)},{name:"Latemar",link:new URL(s(328),s.b)},{name:"Bald Mountains",link:new URL(s(960),s.b)},{name:"Yosemite Valley",link:new URL(s(339),s.b)}];class t{constructor(e,t){let{data:s,handleImageClick:n}=e;this._name=s.name,this._link=s.link,this._cardSelector=t,this._handleImageClick=n}_setEventListeners(){this._likeButton=this._element.querySelector(".card__like-button"),this._likeButton.addEventListener("click",this._handleLikeIcon),this._element.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteCard())),this._imageWindow=this._element.querySelector(".card__image"),this._imageWindow.addEventListener("click",(()=>this._handleImageClick({link:this._link,name:this._name})))}_handleLikeIcon=()=>{this._likeButton.classList.toggle("card__like-button_active")};_handleDeleteCard(){this._element.remove(),this._element=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){this._element=this._getTemplate();const e=this._element.querySelector(".card__image");return e.src=this._link,e.alt=`Photo of ${this._name}`,this._element.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._element}}class n{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputList=this._form.querySelectorAll(this._inputSelector),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleInputState(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkValidity(e){return!e.validity.valid}_hasInvalidInput=()=>Array.from(this._inputList).some(this._checkValidity);_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this.disableButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputState(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}class o{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close-button")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>this.close()))}}class r extends o{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".form__button"),this._formInputs=this._popupForm.querySelectorAll("input"),this._handleFormSubmit=t}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){this._popupForm.reset(),super.close()}}const i=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),a=document.querySelector("#name"),c=document.querySelector("#profession"),u=document.forms["profile-form"],_=document.forms["card-form"],m={};var d;d={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible",formSelector:"form"},Array.from(document.querySelectorAll(d.formSelector)).forEach((e=>{const t=new n(d,e),s=e.getAttribute("name");m[s]=t,t.enableValidation()}));const h=new class extends o{constructor(e){super({popupSelector:e}),this._imageElement=this._popupElement.querySelector(".modal__image"),this._imageCaption=this._popupElement.querySelector(".modal__name"),super.setEventListeners()}open(e){this._imageElement.src=e.link,this._imageElement.alt=`Image ${e.name}`,this._imageCaption.textContent=e.name,super.open()}}("#image-modal");function p(e){return new t({data:e,handleImageClick:e=>{h.open(e)}},"#card-element").getView()}h.close();const f=new class{constructor(e,t){let{items:s,renderer:n}=e;this._renderedItems=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:e,renderer:e=>{const t=p(e);f.addItem(t)}},".cards__list");f.renderItems(e);const E=new r("#add-modal",(e=>{const t=p(e);E.close(),f.addItem(t)}));l.addEventListener("click",(()=>{m[_.getAttribute("name")].resetValidation(),E.open()})),E.setEventListeners();const b=new class{constructor(e,t){this._name=document.querySelector(e),this._profession=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,profession:this._profession.textContent}}setUserInfo(e,t){this._name.textContent=e,this._profession.textContent=t}}(".profile__name",".profile__profession"),v=new r("#edit-modal",(e=>{b.setUserInfo(e.name,e.profession),v.close()}));i.addEventListener("click",(()=>{const e=b.getUserInfo();a.value=e.name,c.value=e.profession,m[u.getAttribute("name")].disableButton(),v.open()})),v.setEventListeners()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UyxLQUVsQ3NGLEVBQWVELEVBQVlNLGFBQWEsU0FBU3BDLGtCQUdqRHVELEVBQWFsRCxNQUFNLElBSXJCa0QsRUFBYTdDLG9CQU9iLE1BQU1nRCxFQUFXLElHNUlGLE1BQ2IvSCxXQUFBQSxDQUFZZ0ksRUFBY0MsR0FDeEI1SCxLQUFLQyxNQUFRaEIsU0FBU3VCLGNBQWNtSCxHQUNwQzNILEtBQUs2SCxZQUFjNUksU0FBU3VCLGNBQWNvSCxFQUM1QyxDQUdBRSxXQUFBQSxHQUNFLE1BQU8sQ0FDTHZJLEtBQU1TLEtBQUtDLE1BQU1zQixZQUNqQndHLFdBQVkvSCxLQUFLNkgsWUFBWXRHLFlBRWpDLENBR0F5RyxXQUFBQSxDQUFZekksRUFBTXdJLEdBQ2hCL0gsS0FBS0MsTUFBTXNCLFlBQWNoQyxFQUN6QlMsS0FBSzZILFlBQVl0RyxZQUFjd0csQ0FDakMsR1JvQ2EsaUJBQ00sd0JLMkZmRSxFQUFnQixJQUFJcEQsRUw5RlQsZUs4RmlEcUQsSUFFaEVSLEVBQVNNLFlBQVlFLEVBQU8zSSxLQUFNMkksRUFBT0gsWUFHekNFLEVBQWMxRCxPQUFPLElBUXZCaUIsRUFBVy9FLGlCQUFpQixTQUFTLEtBRW5DLE1BQU0wSCxFQUFjVCxFQUFTSSxjQUc3QnBDLEVBQWNKLE1BQVE2QyxFQUFZNUksS0FDbENvRyxFQUFvQkwsTUFBUTZDLEVBQVlKLFdBR3hDaEMsRUFBZUgsRUFBWVEsYUFBYSxTQUFTcEQsZ0JBR2pEaUYsRUFBYzVELE1BQU0sSUFJdEI0RCxFQUFjdkQsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3ByYWN0aWN1bS93ZWJwYWNrL3J1bnRpbWUvanNvbnAgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfSIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5iID0gZG9jdW1lbnQuYmFzZVVSSSB8fCBzZWxmLmxvY2F0aW9uLmhyZWY7XG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4vLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbi8vIFtyZXNvbHZlLCByZWplY3QsIFByb21pc2VdID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxudmFyIGluc3RhbGxlZENodW5rcyA9IHtcblx0MTc5OiAwXG59O1xuXG4vLyBubyBjaHVuayBvbiBkZW1hbmQgbG9hZGluZ1xuXG4vLyBubyBwcmVmZXRjaGluZ1xuXG4vLyBubyBwcmVsb2FkZWRcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdFxuXG4vLyBubyBvbiBjaHVua3MgbG9hZGVkXG5cbi8vIG5vIGpzb25wIGZ1bmN0aW9uIiwiLy8gSW1wb3J0IGltYWdlcyBmb3Igd2VicGFjayB0byBhZGQgdGhlIGNvcnJlY3QgcGF0aHMgdG8gdGhlIHZhcmlhYmxlc1xuY29uc3QgbGFnb0RpQnJhaWVzSW1hZ2UgPSBuZXcgVVJMKFxuICBcIi4uL2ltYWdlcy9sYWdvLWRpLWJyYWllcy5qcGdcIixcbiAgaW1wb3J0Lm1ldGEudXJsXG4pO1xuY29uc3QgdmFub2lzZU5hdGlvbmFsUGFya0ltYWdlID0gbmV3IFVSTChcbiAgXCIuLi9pbWFnZXMvdmFub2lzZS1uYXRpb25hbC1wYXJrLmpwZ1wiLFxuICBpbXBvcnQubWV0YS51cmxcbik7XG5jb25zdCBsYWtlTG91aXNlSW1hZ2UgPSBuZXcgVVJMKFwiLi4vaW1hZ2VzL2xha2UtbG91aXNlLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgbGF0ZW1hckltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy9sYXRlbWFyLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgYmFsZE1vdW50YWluc0ltYWdlID0gbmV3IFVSTChcbiAgXCIuLi9pbWFnZXMvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIGltcG9ydC5tZXRhLnVybFxuKTtcbmNvbnN0IHlvc2VtaXRlVmFsbGV5SW1hZ2UgPSBuZXcgVVJMKFxuICBcIi4uL2ltYWdlcy95b3NlbWl0ZS12YWxsZXkuanBnXCIsXG4gIGltcG9ydC5tZXRhLnVybFxuKTtcblxuLy8gQ3JlYXRlIGFuIGluaXRpYWwgbGlzdCBvZiBjYXJkc1xuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBsYWdvRGlCcmFpZXNJbWFnZSxcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogdmFub2lzZU5hdGlvbmFsUGFya0ltYWdlLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IGxha2VMb3Vpc2VJbWFnZSxcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IGxhdGVtYXJJbWFnZSxcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBiYWxkTW91bnRhaW5zSW1hZ2UsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IHlvc2VtaXRlVmFsbGV5SW1hZ2UsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xuICBjYXJkc0xpc3Q6IFwiLmNhcmRzX19saXN0XCIsXG4gIGNhcmRUZW1wbGF0ZTogXCIjY2FyZC1lbGVtZW50XCIsXG4gIHByZXZpZXdQb3B1cDogXCIjaW1hZ2UtbW9kYWxcIixcbiAgZWRpdEZvcm1Qb3B1cDogXCIjZWRpdC1tb2RhbFwiLFxuICBhZGRGb3JtUG9wdXA6IFwiI2FkZC1tb2RhbFwiLFxuICBwcm9maWxlTmFtZTogXCIucHJvZmlsZV9fbmFtZVwiLFxuICBwcm9maWxlUHJvZmVzc2lvbjogXCIucHJvZmlsZV9fcHJvZmVzc2lvblwiLFxuICBmb3JtTW9kYWxDb250YWluZXI6IFwiLm1vZGFsX19jb250YWluZXJcIixcbiAgaW1hZ2VNb2RhbENvbnRhaW5lcjogXCIubW9kYWxfX3BvcHVwXCIsXG4gIGZvcm1JbnB1dE5hbWU6IFwiI25hbWVcIixcbiAgZm9ybUlucHV0UHJvZmVzc2lvbjogXCIjcHJvZmVzc2lvblwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2Vycm9yX3Zpc2libGVcIixcbiAgZm9ybVNlbGVjdG9yOiBcImZvcm1cIixcbn07XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoeyBkYXRhLCBoYW5kbGVJbWFnZUNsaWNrIH0sIGNhcmRTZWxlY3Rvcikge1xuICAgIC8vIEZpbmQgdGhlIGRhdGEncyBuYW1lIGFuZCBsaW5rXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuXG4gICAgLy8gRmluZCB0aGUgY2FyZCBzZWxlY3RvclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcblxuICAgIC8vIEhhbmRsZSB0aGUgaW1hZ2UtY2xpY2sgZnVuY3Rpb25cbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBBZGQgZXZlbnQgbGlzdG5lciBmb3IgbGlrZSBidXR0b25cbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2VJY29uKTtcblxuICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lciBmb3IgdGhlIGRlbGV0ZSBidXR0b25cbiAgICBjb25zdCBkZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcbiAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKSk7XG5cbiAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGltYWdlXG4gICAgdGhpcy5faW1hZ2VXaW5kb3cgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5faW1hZ2VXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbGluazogdGhpcy5fbGluaywgbmFtZTogdGhpcy5fbmFtZSB9KVxuICAgICk7XG4gIH1cblxuICBfaGFuZGxlTGlrZUljb24gPSAoKSA9PiB7XG4gICAgLy8gQWRkIGFjdGl2ZSBjbGFzcyB0byBjYXJkJ3MgbGlrZSBidXR0b25cbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH07XG5cbiAgX2hhbmRsZURlbGV0ZUNhcmQoKSB7XG4gICAgLy8gUmVtb3ZlIGVsZW1lbnQgZnJvbSB0aGUgRE9NIG9uIGNsaWNrXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcblxuICAgIC8vIFJlbW92ZSB0aGUgbGluayB0byB0aGUgRE9NIGVsZW1lbnRcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICAvLyBHZXQgY2FyZCB0ZW1wbGF0ZVxuICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICAvLyBDcmVhdGUgY2FyZCB0ZW1wbGF0ZVxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuXG4gICAgLy8gU2V0IHRoZSBpbWFnZSBsaW5rXG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIGNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIGNhcmRJbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHt0aGlzLl9uYW1lfWA7XG5cbiAgICAvLyBTZXQgdGhlIGNhcmQgdGl0bGVcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIC8vIFNldCB0aGUgZXZlbnQgbGlzdGVuZXJzXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgLy8gR2VuZXJhdGUgdGhlIGlkIGZvciBlcnJvciBmb3IgdGhlIHRhcmdldCBlbGVtZW50XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG5cbiAgICAvLyBBZGQgdGhlIGlucHV0IGVycm9yIGNsYXNzIHRvIHRoZSBlbGVtZW50J3MgY2xhc3MgbGlzdFxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG5cbiAgICAvLyBDaGFuZ2UgdGhlIHRleHQgY29udGVudCB0byB0aGUgZXJyb3IgbWVzc2FnZVxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG5cbiAgICAvLyBBZGQgdGhlIGVycm9yIGNsYXNzIHRvIHRoZSBlcnJvciBtZXNzYWdlJ3MgY2xhc3MgbGlzdFxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICAvLyBHZW5lcmF0ZSB0aGUgaWQgZm9yIGVycm9yIGZvciB0aGUgdGFyZ2V0IGVsZW1lbnRcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcblxuICAgIC8vIEFkZCB0aGUgaW5wdXQgZXJyb3IgY2xhc3MgdG8gdGhlIGVsZW1lbnQncyBjbGFzcyBsaXN0XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcblxuICAgIC8vIENsZWFyIHRoZSBlcnJvciBtZXNzYWdlIGZyb20gdGhlIHRleHQgY29udGVudFxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuXG4gICAgLy8gQWRkIHRoZSBlcnJvciBjbGFzcyB0byB0aGUgZXJyb3IgbWVzc2FnZSdzIGNsYXNzIGxpc3RcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICAvLyBEaXNhYmxlIGZvcm0gYnV0dG9uXG4gIGRpc2FibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIC8vIEVuYWJsZSBmb3JtIGJ1dHRvblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgLy8gU2hvdyBvciBoaWRlIGlucHV0IGVycm9ycyBiYXNlZCBvbiB0aGUgY3VycmVudCBpbnB1dCBlbGVtZW50J3MgdmFsaWRpdHlcbiAgX3RvZ2dsZUlucHV0U3RhdGUoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIC8vIElmIGlucHV0IGVsZW1lbnQgaXMgaW52YWxpZCwgc2hvdyBpbnB1dCBlcnJvciBtZXNzYWdlXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBPdGhlcndpc2UsIGhpZGUgaW5wdXQgZXJyb3IgbWVzc2FnZVxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICAvLyBDaGVjayBpZiB0aGUgaW5wdXQgZWxlbWVudCBpcyBpbnZhbGlkXG4gIF9jaGVja1ZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICB9XG5cbiAgLy8gQ2hlY2sgaWYgYW55IGVsZW1lbnQgaW4gdGhlIGlucHV0IGxpc3QgaXMgaW52YWxpZFxuICAvLyBSZWZlcmVuY2UgKDEpOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9zb21lXG4gIC8vIFJlZmVyZW5jZSAoMik6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L2Zyb21cbiAgX2hhc0ludmFsaWRJbnB1dCA9ICgpID0+XG4gICAgQXJyYXkuZnJvbSh0aGlzLl9pbnB1dExpc3QpLnNvbWUodGhpcy5fY2hlY2tWYWxpZGl0eSk7XG5cbiAgLy8gVG9nZ2xlIGJ1dHRvbiBkZXBlbmRpbmcgb24gdGhlIGlucHV0J3MgdmFsaWRpdHlcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIC8vIElmIHRoZSBpbnB1dCBpcyB2YWxpZCwgZGlzYWJsZSB0aGUgYnV0dG9uXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gT3RoZXJ3aXNlLCBlbmFibGUgdGhlIGJ1dHRvblxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gICAgfVxuICB9XG5cbiAgLy8gU2V0IGV2ZW50IGxpc3RlbmVycyBmb3IgZm9ybSBlbGVtZW50cyBiYXNlZCBvbiB0aGUgdXNlciBpbnB1dHMnIHZhbGlkaXR5XG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBEaXNhYmxlIGJ1dHRvblxuICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuXG4gICAgLy8gTGlzdGVuIGZvciB0aGUgXCJ0eXBlXCIgZXZlbnQgb24gZWFjaCBpbnB1dFxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl90b2dnbGVJbnB1dFN0YXRlKGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFZhbGlkYXRlIGZvcm1cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAvLyBQcmV2ZW50IHRoZSBmb3JtJ3MgZGVmYXVsdCBiZWhhdmlvdXJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICAvLyBTZXQgZXZlbnQgbGlzdGVuZXJzXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICAvLyBSZXNldCBzdWJtaXQgYnV0dG9uXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgIC8vIENsZWFyIGVycm9yIG1lc3NhZ2VzXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxuICAgICk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIC8vIG9wZW4gcG9wdXBcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcblxuICAgIC8vIExpc3RlbiBmb3IgdGhlIFwiRXNjYXBlXCIga2V5IGV2ZW50XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgLy8gY2xvc2UgcG9wdXBcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcblxuICAgIC8vIFJlbW92ZSBsaXN0ZW5lciBmb3IgdGhlIFwiRXNjYXBlXCIga2V5IGV2ZW50XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2ZW50KSA9PiB7XG4gICAgLy8gUHJldmVudCBkZWZhdWx0IGFuZCBpZiBldmVudCB3YXMgb24gRVNDIGJ1dHRvbiBjYWxsIHRoZSBcImNsb3NlXCIgbWV0aG9kXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBDbG9zZSB0aGUgcG9wdXAgd2hlbiB1c2VycyBjbGljayBvbiB0aGUgc2hhZGVkIGFyZWEgb3V0c2lkZSB0aGUgbW9kYWxcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gZXZlbnQuY3VycmVudFRhcmdldCkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBDbG9zZSB0aGUgcG9wdXAgd2hlbiB1c2VycyBjbGljayBvbiB0aGUgJ2Nsb3NlJyBidXR0b25cbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcImlucHV0XCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICB9XG5cbiAgLy8gQ29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIGFuZCByZXR1cm5zIHRoZSBkYXRhIGFzIGFuIG9iamVjdFxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgLy8gTWFrZSBhIGlucHV0IGRhdGEgb2JqZWN0XG4gICAgY29uc3QgaW5wdXRPYmplY3QgPSB7fTtcblxuICAgIC8vIE5hbWUgZWFjaCBpbnB1dCBieSBpdHMgdmFsdWVcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dE9iamVjdFtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuXG4gICAgLy8gUmV0dXJuIHRoZSBkYXRhIGFzIGFuIG9iamVjdFxuICAgIHJldHVybiBpbnB1dE9iamVjdDtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIEFkZCB0aGUgJ2NsaWNrJyBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xvc2UgaWNvblxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAvLyBBZGQgdGhlICdzdWJtaXQnIGV2ZW50IGhhbmRsZXIgdG8gdGhlIGZvcm1cbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgLy8gUmVzZXQgdGhlIGZvcm1cbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcblxuICAgIC8vIENsb3NlIHRoZSBmb3JtXG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCB7XG4gIGluaXRpYWxDYXJkcyxcbiAgc2VsZWN0b3JzLFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHNcIjtcblxuLy8gSW1wb3J0IGFsbCB0aGUgY2xhc3Nlc1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZFwiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvclwiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvblwiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcblxuLy8gSWRlbnRpZnkgZWRpdCwgYWRkIGFuZCBjbG9zZSBidXR0b25zIGFzIGVsZW1lbnRzXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuLy8gRmluZCBlZGl0IGZvcm0gaW5wdXQgZWxlbWVudHNcbmNvbnN0IGZvcm1JbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25hbWVcIik7XG5jb25zdCBmb3JtSW5wdXRQcm9mZXNzaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9mZXNzaW9uXCIpO1xuXG4vLyBGaW5kIGZvcm0gZWxlbWVudHNcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XG5jb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiY2FyZC1mb3JtXCJdO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRm9ybSBWYWxpZGF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIENyZWF0ZSBhIGZvcm0gdmFsaWRhdG9ycyBvYmplY3RcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbi8vIENyZWF0ZSB2YWxpZGF0b3IgaW5zdGFuY2VzIGZvciBhbGwgZm9ybXNcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAodmFsaWRhdGlvblNldHRpbmdzKSA9PiB7XG4gIC8vIENyZWF0ZSBhbiBhcnJheSBvZiBhbGwgZm9ybXNcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvblNldHRpbmdzLmZvcm1TZWxlY3RvcilcbiAgKTtcblxuICAvLyBDcmVhdGUgYSB2YWxpZGF0b3IgZm9yIGVhY2ggZm9ybVxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIC8vIENyZWF0ZSBhIHZhbGlkYXRvciBpbnN0YW5jZSBmb3IgdGhlIGN1cnJlbnQgaW5zdGFuY2VcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGZvcm1FbGVtZW50KTtcblxuICAgIC8vIFJldHJpZXZlIHRoZSBmb3JtIGVsZW1lbnQgYnkgaXRzIG5hbWVcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XG5cbiAgICAvLyBTdG9yZSB0aGUgY3VycmVudCBmb3JtIHZhbGlkYXRvciBpbiB0aGUgdmFsaWRhdG9ycyBvYmplY3RcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG5cbiAgICAvLyBFbmFibGUgdmFsaWRhdGlvbiBmb3IgdGhlIGN1cnJlbnQgZm9ybVxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gIH0pO1xufTtcblxuLy8gRW5hYmxlIHZhbGlkYXRpb24gZm9yIGFsbCBmb3Jtc1xuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uU2V0dGluZ3MpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3B1cCBJbWFnZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIENyZWF0ZSBpbWFnZSBwb3B1cCBpbnN0YW5jZVxuY29uc3QgY2FyZFByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3RvcnMucHJldmlld1BvcHVwKTtcblxuLy8gQ2xvc2UgaW1hZ2UgcG9wdXAgcHJldmlld1xuY2FyZFByZXZpZXdQb3B1cC5jbG9zZSgpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhcmQgU2VjdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIFRoaXMgZnVuY3Rpb24gY3JlYXRlcyBhIG5ldyBjYXJkXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcbiAgICB7XG4gICAgICBkYXRhLFxuICAgICAgaGFuZGxlSW1hZ2VDbGljazogKGltYWdlRGF0YSkgPT4ge1xuICAgICAgICBjYXJkUHJldmlld1BvcHVwLm9wZW4oaW1hZ2VEYXRhKTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICBzZWxlY3RvcnMuY2FyZFRlbXBsYXRlXG4gICk7XG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50LmdldFZpZXcoKTtcbn1cblxuLy8gQ3JlYXRlIGEgc2VjdGlvbiBvZiBjYXJkc1xuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgYSBuZXcgY2FyZFxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuXG4gICAgICAvLyBEaXNwbGF5IGVhY2ggY2FyZFxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgfSxcbiAgfSxcbiAgc2VsZWN0b3JzLmNhcmRzTGlzdFxuKTtcblxuLy8gUmVuZGVyIHRoZSBpbml0aWFsIGxpc3Qgb2YgY2FyZHMgb24gdGhlIHBhZ2VcbmNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKGluaXRpYWxDYXJkcyk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZGQgRm9ybSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLy8gQ3JlYXRlIHRoZSBhZGQgZm9ybSBpbnN0YW5jZVxuY29uc3QgYWRkRm9ybVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oc2VsZWN0b3JzLmFkZEZvcm1Qb3B1cCwgKGZvcm1EYXRhKSA9PiB7XG4gIC8vIENyZWF0ZSBhIG5ldyBjYXJkXG4gIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKGZvcm1EYXRhKTtcblxuICAvLyBDbG9zZSB0aGUgYWRkIGZvcm1cbiAgYWRkRm9ybVBvcHVwLmNsb3NlKCk7XG5cbiAgLy8gQWRkIHRoZSBuZXcgY2FyZCB0byB0aGUgc2VjdGlvblxuICBjYXJkU2VjdGlvbi5hZGRJdGVtKG5ld0NhcmQpO1xufSk7XG5cbi8vIE9wZW4gdGhlIG1vZGFsIHdoZW4gdXNlcnMgY2xpY2sgb24gdGhlIGFkZCBidXR0b25cbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAvLyBSZXNldCB2YWxpZGF0aW9uIGZvciB0aGUgYWRkIGNhcmQgZm9ybVxuICBmb3JtVmFsaWRhdG9yc1thZGRDYXJkRm9ybS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldFZhbGlkYXRpb24oKTtcblxuICAvLyBPcGVuIHRoZSBhZGQgY2FyZCBmb3JtXG4gIGFkZEZvcm1Qb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gU2V0IGFkZCBmb3JtIGV2ZW50IGxpc3RlbmVyc1xuYWRkRm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJvZmlsZSBJbmZvcm1hdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLy8gQ3JlYXRlIHRoZSB1c2VyIGluZm8gaW5zdGFuY2VcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxuICBzZWxlY3RvcnMucHJvZmlsZU5hbWUsXG4gIHNlbGVjdG9ycy5wcm9maWxlUHJvZmVzc2lvblxuKTtcblxuLy8gQ3JlYXRlIHRoZSBlZGl0IGZvcm0gaW5zdGFuY2VcbmNvbnN0IGVkaXRGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuZWRpdEZvcm1Qb3B1cCwgKHZhbHVlcykgPT4ge1xuICAvLyBBZGQgdGhlIGZvcm0ncyBpbnB1dCB0byB0aGUgcHJvZmlsZSBzZWN0aW9uXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHZhbHVlcy5uYW1lLCB2YWx1ZXMucHJvZmVzc2lvbik7XG5cbiAgLy8gQ2xvc2UgdGhlIGVkaXQgZm9ybVxuICBlZGl0Rm9ybVBvcHVwLmNsb3NlKCk7XG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVkaXQgRm9ybSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vLyBPcGVuIHRoZSBtb2RhbCB3aGVuIHVzZXJzIGNsaWNrIG9uIHRoZSBlZGl0IGJ1dHRvblxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAvLyBHZXQgcHJvZmlsZSBpbmZvIGFuZCBhZGQgdG8gdGhlIGZvcm0gZmllbGRzXG4gIGNvbnN0IHByb2ZpbGVJbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcblxuICAvLyBBZGQgdGhlIHByb2ZpbGUgaW5mbyBvbiB0aGUgcGFnZSB0byB0aGUgZm9ybSdzIGZpZWxkc1xuICBmb3JtSW5wdXROYW1lLnZhbHVlID0gcHJvZmlsZUluZm8ubmFtZTtcbiAgZm9ybUlucHV0UHJvZmVzc2lvbi52YWx1ZSA9IHByb2ZpbGVJbmZvLnByb2Zlc3Npb247XG5cbiAgLy8gRGlzYWJsZSBidXR0b24gZWFjaCB0aW1lIGl0IG9wZW5zXG4gIGZvcm1WYWxpZGF0b3JzW3Byb2ZpbGVGb3JtLmdldEF0dHJpYnV0ZShcIm5hbWVcIildLmRpc2FibGVCdXR0b24oKTtcblxuICAvLyBPcGVuIG1vZGFsXG4gIGVkaXRGb3JtUG9wdXAub3BlbigpO1xufSk7XG5cbi8vIFNldCBlZGl0IGZvcm0gZXZlbnQgbGlzdGVuZXJzXG5lZGl0Rm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19uYW1lXCIpO1xuXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIG9wZW4oaW1hZ2VEYXRhKSB7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGltYWdlRGF0YS5saW5rO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBgSW1hZ2UgJHtpbWFnZURhdGEubmFtZX1gO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGltYWdlRGF0YS5uYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICAvLyBSZW5kZXJzIGFsbCBlbGVtZW50cyBvbiB0aGUgcGFnZVxuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICAvLyBBZGRzIHRoZSBET00gZWxlbWVudCB0byB0aGUgY29udGFpbmVyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBwcm9mZXNzaW9uU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX3Byb2Zlc3Npb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2Zlc3Npb25TZWxlY3Rvcik7XG4gIH1cblxuICAvLyBSZXRyaWV2ZSBwcm9maWxlIGluZm8gZnJvbSB0aGUgcGFnZVxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcbiAgICAgIHByb2Zlc3Npb246IHRoaXMuX3Byb2Zlc3Npb24udGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIC8vIEFkZCBuZXcgcHJvZmlsZSBpbmZvIHRvIHRoZSBwYWdlXG4gIHNldFVzZXJJbmZvKG5hbWUsIHByb2Zlc3Npb24pIHtcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9wcm9mZXNzaW9uLnRleHRDb250ZW50ID0gcHJvZmVzc2lvbjtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwibSIsIm8iLCJvYmoiLCJwcm9wIiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwicCIsImIiLCJkb2N1bWVudCIsImJhc2VVUkkiLCJzZWxmIiwibG9jYXRpb24iLCJocmVmIiwiaW5pdGlhbENhcmRzIiwibmFtZSIsImxpbmsiLCJVUkwiLCJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiZGF0YSIsImhhbmRsZUltYWdlQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiX2VsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlSWNvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2ltYWdlV2luZG93IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicmVtb3ZlIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImdldFZpZXciLCJjYXJkSW1hZ2UiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsIl9lbmFibGVCdXR0b24iLCJfdG9nZ2xlSW5wdXRTdGF0ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tWYWxpZGl0eSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJBcnJheSIsImZyb20iLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9mb3JtSW5wdXRzIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dE9iamVjdCIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJmb3JtSW5wdXROYW1lIiwiZm9ybUlucHV0UHJvZmVzc2lvbiIsInByb2ZpbGVGb3JtIiwiZm9ybXMiLCJhZGRDYXJkRm9ybSIsImZvcm1WYWxpZGF0b3JzIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJjYXJkUHJldmlld1BvcHVwIiwiX2ltYWdlRWxlbWVudCIsIl9pbWFnZUNhcHRpb24iLCJpbWFnZURhdGEiLCJjcmVhdGVDYXJkIiwiY2FyZFNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJjYXJkRWxlbWVudCIsImFkZEZvcm1Qb3B1cCIsImZvcm1EYXRhIiwibmV3Q2FyZCIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwicHJvZmVzc2lvblNlbGVjdG9yIiwiX3Byb2Zlc3Npb24iLCJnZXRVc2VySW5mbyIsInByb2Zlc3Npb24iLCJzZXRVc2VySW5mbyIsImVkaXRGb3JtUG9wdXAiLCJ2YWx1ZXMiLCJwcm9maWxlSW5mbyJdLCJzb3VyY2VSb290IjoiIn0=