!function(){"use strict";class e{constructor(e,t,n){let{name:r,link:o}=e;this._name=r,this._link=o,this._cardSelector=t,this._handleImageClick=n}_setEventListeners(){this._cardElement.querySelector(".cards__like-button").addEventListener("click",(()=>{this._handleLikeIcon()})),this._cardElement.querySelector(".cards__delete-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardElement.querySelector(".cards__image").addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}_handleDeleteCard(){this._cardElement.remove()}_handleLikeIcon(){this._cardElement.querySelector(".cards__like-button").classList.toggle("cards__like-button_active")}getView(){const e=this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".cards__list-item").cloneNode(!0),t=e.querySelector(".cards__image");return t.src=this._link,t.alt=this._name,e.querySelector(".cards__title").textContent=this._name,this._setEventListeners(),e}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}toggleButtonState(){if(this._hasInvalidInput(this._inputEls))return this._submitButton.classList.add(this._inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const n=document.querySelector("#profile__edit-button"),r=document.querySelector("#profile__edit-modal"),o=r.querySelector(".modal__close"),s=document.querySelector(".profile__title"),i=document.querySelector(".profile__description"),a=document.querySelector("#profile-title-input"),l=document.querySelector("#profile-description-input"),c=r.querySelector(".modal__form"),u=document.querySelector("#card__add-modal"),d=u.querySelector(".modal__close"),_=(document.querySelector("#card-template").content.firstElementChild,document.querySelector(".cards__list")),m=document.querySelector("#profile__add-button"),p=u.querySelector("#add__card-form"),h=p.querySelector(".modal__input_type_title"),v=p.querySelector(".modal__input_type_url"),y=document.querySelector("#preview__image-modal"),S=y.querySelector(".modal__close"),E=y.querySelector(".modal__preview-image"),f=y.querySelector(".modal__preview-text");function k(e){e.classList.add("modal_opened"),document.addEventListener("keydown",q)}function L(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",q)}function q(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&L(e)}}const g=[r,u,y];function w(t){return new e(t,"#card-template",((e,t)=>{E.src=t,E.alt=e,f.textContent=e,k(y)})).getView()}n.addEventListener("click",(()=>{a.value=s.textContent,l.value=i.textContent,k(r)})),o.addEventListener("click",(()=>{L(r)})),d.addEventListener("click",(()=>{L(u)})),S.addEventListener("click",(()=>{L(y)})),m.addEventListener("click",(()=>{k(u)})),c.addEventListener("submit",(function(e){e.preventDefault(),s.textContent=a.value,i.textContent=l.value,L(r)})),p.addEventListener("submit",(function(e){e.preventDefault(),function(e){const t=w(e);_.prepend(t)}({name:h.value,link:v.value}),L(u),p.reset(),B.toggleButtonState()})),[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}].forEach((e=>{const t=w(e);_.prepend(t)}));const b={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},C=new t(b,c),B=new t(b,p);B.enableValidation(),C.enableValidation(),g.forEach((e=>{e.addEventListener("mousedown",(t=>{t.target.matches(".modal")&&L(e)}))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUpTMkUsRUFBZWlCLE1BS3hCM0YsS0FKUzJFLEVBQWFnQixRQVExQlIsRUFBV2YsR0FDWEssRUFBZXNCLFFBQ2ZDLEVBQWlCbEQsbUJBQ25CLElBdktxQixDQUNuQixDQUNFL0MsS0FBTSxrQkFDTkMsS0FBTSxzR0FFUixDQUNFRCxLQUFNLGNBQ05DLEtBQU0seUdBRVIsQ0FDRUQsS0FBTSxpQkFDTkMsS0FBTSw0R0FFUixDQUNFRCxLQUFNLFVBQ05DLEtBQU0scUdBRVIsQ0FDRUQsS0FBTSx3QkFDTkMsS0FBTSxxR0FFUixDQUNFRCxLQUFNLGlCQUNOQyxLQUFNLG1HQStLR3dELFNBQVNrQyxJQUNwQixNQUFNRSxFQUFXSCxFQUFXQyxHQUM1QnBCLEVBQVd1QixRQUFRRCxFQUFTLElBSzlCLE1BQU1LLEVBQXFCLENBQ3pCckUsY0FBZSxnQkFDZkUscUJBQXNCLGlCQUN0QkUsb0JBQXFCLHlCQUNyQkUsZ0JBQWlCLDBCQUNqQkUsV0FBWSx3QkFFUjhELEVBQW9CLElBQUkxRSxFQUM1QnlFLEVBQ0E5QixHQUVJNkIsRUFBbUIsSUFBSXhFLEVBQWN5RSxFQUFvQnhCLEdBQy9EdUIsRUFBaUJ2QyxtQkFDakJ5QyxFQUFrQnpDLG1CQUtsQitCLEVBQU9oQyxTQUFTeUIsSUFDZEEsRUFBTXhFLGlCQUFpQixhQUFjaUQsSUFDL0JBLEVBQUV5QyxPQUFPQyxRQUFRLFdBQ25CakIsRUFBV0YsRUFDYixHQUNBLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIGxpbmsgfSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICB9XG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBMSUtFIEJVVFRPTlxuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlrZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbigpO1xuICAgICAgfSk7XG4gICAgLy8gREVMRVRFIEJVVFRPTlxuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKTtcbiAgICAgIH0pO1xuICAgIC8vICAgSU1BR0UgUFJFVklFV1xuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkc19faW1hZ2VcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xuICAgICAgfSk7XG4gIH1cbiAgX2hhbmRsZURlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICBfaGFuZGxlTGlrZUljb24oKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlLWJ1dHRvblwiKVxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkc19fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICBjb25zdCBub2RlID0gKHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3QtaXRlbVwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKSk7XG5cbiAgICBjb25zdCBjYXJkSW1hZ2VFbCA9IG5vZGUucXVlcnlTZWxlY3RvcihcIi5jYXJkc19faW1hZ2VcIik7XG4gICAgY2FyZEltYWdlRWwuc3JjID0gdGhpcy5fbGluaztcbiAgICBjYXJkSW1hZ2VFbC5hbHQgPSB0aGlzLl9uYW1lO1xuXG4gICAgY29uc3QgY2FyZFRpdGxlRWwgPSBub2RlLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX3RpdGxlXCIpO1xuICAgIGNhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gbm9kZTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKSkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG4gIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gICAgcmV0dXJuICFpbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKGlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcblxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcblxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gKiBFbGVtZW50cyBwcm9maWxlIGVkaXQgbW9kYWwgKlxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX19lZGl0LW1vZGFsXCIpO1xuY29uc3QgcHJvZmlsZUVkaXRDbG9zZSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5jb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gKiBFbGVtZW50cyBOZXcgQ2FyZCBNb2RhbCAqXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuY29uc3QgYWRkTmV3Q2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkX19hZGQtbW9kYWxcIik7XG5jb25zdCBhZGROZXdDYXJkQ2xvc2VCdXR0b24gPSBhZGROZXdDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogQ2FyZCB0ZW1wbGF0ZSBhbmQgY2FyZCBsaXN0ICpcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuY29uc3QgY2FyZFRlbXBsYXRlID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG5jb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogQ2FyZCBhZGQgQnV0dG9uIC8gRm9ybSAqXG4gKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5jb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgYWRkTmV3Q2FyZEZvcm0gPSBhZGROZXdDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGRfX2NhcmQtZm9ybVwiKTtcbmNvbnN0IGNhcmRUaXRsZUlucHV0ID0gYWRkTmV3Q2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV90aXRsZVwiKTtcbmNvbnN0IGNhcmRVcmxJbnB1dCA9IGFkZE5ld0NhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfdXJsXCIpO1xuLyoqKioqKioqKioqKioqKioqKioqKioqXG4gKiBQUkVWSUVXIElNQUdFIE1PREFMICpcbiAqKioqKioqKioqKioqKioqKioqKioqKi9cbmNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3X19pbWFnZS1tb2RhbFwiKTtcbmNvbnN0IHByZXZpZXdJbWFnZUNsb3NlID0gcHJldmlld0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5jb25zdCBwcmV2aWV3SW1hZ2VFbGVtZW50ID0gcHJldmlld0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIlxuKTtcbmNvbnN0IHByZXZpZXdJbWFnZVRleHQgPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fcHJldmlldy10ZXh0XCJcbik7XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAqIFJFTU9WRSBDQVJELCBPUEVOIEFORCBDTE9TRSBNT0RBTCBGVU5DVElPTlNcbiAqID9JbmNsdWRlcyBcIkVzY1wiIGtleSBsb2dpYyAqXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbmZ1bmN0aW9uIG9wZW5Qb3B1cChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZUJ5RXNjYXBlKTtcbn1cbmZ1bmN0aW9uIGNsb3NlUG9wdXAobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VCeUVzY2FwZSk7XG59XG5mdW5jdGlvbiBjbG9zZUJ5RXNjYXBlKGV2dCkge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgaWYgKG9wZW5lZFBvcHVwKSB7XG4gICAgICBjbG9zZVBvcHVwKG9wZW5lZFBvcHVwKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqKioqKioqKipcbiAqIEFSUkFZUyAqXG4gKioqKioqKioqKi9cbmNvbnN0IG1vZGFscyA9IFtwcm9maWxlRWRpdE1vZGFsLCBhZGROZXdDYXJkTW9kYWwsIHByZXZpZXdJbWFnZU1vZGFsXTtcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAqIENhcmQgVEVNUExBVEUgRlVOQ1RJT05TICpcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vLyAhIENhcmQgQ2xhc3Ncbi8vIGZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGNhcmREYXRhKSB7XG4vLyAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcbi8vICAgLy8gY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2RlbGV0ZS1idXR0b25cIik7XG4vLyAgIC8vIGNhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbi8vICAgLy8gICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcbi8vICAgLy8gfSk7XG4vLyAgIC8qKioqKioqKioqKioqKioqKioqKioqXG4vLyAgICAqIENhcmQgUHJldmlldyBQb3B1cCAqXG4vLyAgICAqKioqKioqKioqKioqKioqKioqKioqL1xuLy8gICBjb25zdCBjYXJkSW1hZ2VFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2ltYWdlXCIpO1xuLy8gICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuLy8gICAgIHByZXZpZXdJbWFnZUVsZW1lbnQuc3JjID0gY2FyZERhdGEubGluaztcbi8vICAgICBwcmV2aWV3SW1hZ2VUZXh0LnRleHRDb250ZW50ID0gY2FyZERhdGEubmFtZTtcbi8vICAgICBwcmV2aWV3SW1hZ2VFbGVtZW50LmFsdCA9IGNhcmREYXRhLm5hbWU7XG4vLyAgICAgb3BlblBvcHVwKHByZXZpZXdJbWFnZU1vZGFsKTtcbi8vICAgfSk7XG4vLyAgIC8vIGNvbnN0IGNhcmRUaXRsZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fdGl0bGVcIik7XG4vLyAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4vLyAgICAqIExpa2UgQnV0dG9uIExpc3RlbmVyIGZvciBMaWtlIEFDVElWRSAqXG4vLyAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLy8gICAvLyBjb25zdCBsaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlrZS1idXR0b25cIik7XG4vLyAgIC8vIGxpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbi8vICAgLy8gICBsaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkc19fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuLy8gICAvLyB9KTtcbi8vICAgLy8gY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSBjYXJkRGF0YS5uYW1lO1xuLy8gICAvLyBjYXJkSW1hZ2VFbC5zcmMgPSBjYXJkRGF0YS5saW5rO1xuLy8gICAvLyBjYXJkSW1hZ2VFbC5hbHQgPSBjYXJkRGF0YS5uYW1lO1xuLy8gICAvLyByZXR1cm4gY2FyZEVsZW1lbnQ7XG4vLyB9XG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgKG5hbWUsIGxpbmspID0+IHtcbiAgICBwcmV2aWV3SW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7XG4gICAgcHJldmlld0ltYWdlRWxlbWVudC5hbHQgPSBuYW1lO1xuICAgIHByZXZpZXdJbWFnZVRleHQudGV4dENvbnRlbnQgPSBuYW1lO1xuXG4gICAgb3BlblBvcHVwKHByZXZpZXdJbWFnZU1vZGFsKTtcbiAgfSk7XG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRWaWV3KCk7XG59XG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmROb2RlID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG5cbiAgY2FyZExpc3RFbC5wcmVwZW5kKGNhcmROb2RlKTtcbn1cbi8vICFDYXJkIENsYXNzXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogRVZFTlQgSEFORExFUlMgRk9SIFNVTUJJVFRJTkcgUFJPRklMRSBBTkQgQ0FSRCBEQVRBICpcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoZSkge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudCA9IHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlO1xuICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZTtcbiAgY2xvc2VQb3B1cChwcm9maWxlRWRpdE1vZGFsKTtcbn1cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBuYW1lID0gY2FyZFRpdGxlSW5wdXQudmFsdWU7XG4gIGNvbnN0IGxpbmsgPSBjYXJkVXJsSW5wdXQudmFsdWU7XG4gIHJlbmRlckNhcmQoXG4gICAge1xuICAgICAgbmFtZSxcbiAgICAgIGxpbmssXG4gICAgfSxcbiAgICBjYXJkTGlzdEVsXG4gICk7XG4gIGNsb3NlUG9wdXAoYWRkTmV3Q2FyZE1vZGFsKTtcbiAgYWRkTmV3Q2FyZEZvcm0ucmVzZXQoKTtcbiAgYWRkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xufVxuLyoqKioqKioqKioqKioqKioqKipcbiAqIEVWRU5UIExJU1RFTkVSUyAqXG4gKioqKioqKioqKioqKioqKioqKi9cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gcHJvZmlsZVRpdGxlLnRleHRDb250ZW50O1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgb3BlblBvcHVwKHByb2ZpbGVFZGl0TW9kYWwpO1xufSk7XG5cbnByb2ZpbGVFZGl0Q2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VQb3B1cChwcm9maWxlRWRpdE1vZGFsKTtcbn0pO1xuYWRkTmV3Q2FyZENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlUG9wdXAoYWRkTmV3Q2FyZE1vZGFsKTtcbn0pO1xucHJldmlld0ltYWdlQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VQb3B1cChwcmV2aWV3SW1hZ2VNb2RhbCk7XG59KTtcblxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuUG9wdXAoYWRkTmV3Q2FyZE1vZGFsKTtcbn0pO1xucHJvZmlsZUVkaXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQpO1xuYWRkTmV3Q2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdCk7XG5cbi8vIGluaXRpYWxDYXJkcy5mb3JFYWNoKChyZW5kZXJDYXJkKSA9PiB7XG4vLyAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQocmVuZGVyQ2FyZCk7XG4vLyAgIGNhcmRMaXN0RWwucHJlcGVuZChjYXJkRWxlbWVudCk7XG4vLyB9KTtcblxuaW5pdGlhbENhcmRzLmZvckVhY2goKGNhcmREYXRhKSA9PiB7XG4gIGNvbnN0IGNhcmROb2RlID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gIGNhcmRMaXN0RWwucHJlcGVuZChjYXJkTm9kZSk7XG59KTtcbi8qKioqKioqKioqKioqKlxuICogVmFsaWRhdGlvbiAqXG4gKioqKioqKioqKioqKiovXG5jb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHByb2ZpbGVFZGl0Rm9ybVxuKTtcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGFkZE5ld0NhcmRGb3JtKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuLyoqKioqKioqKioqKioqKioqKioqKioqKlxuICogQ0xPU0UgTU9EQUwgQlkgQ0xJQ0sgKlxuICoqKioqKioqKioqKioqKioqKioqKioqKi9cblxubW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcbiAgICBpZiAoZS50YXJnZXQubWF0Y2hlcyhcIi5tb2RhbFwiKSkge1xuICAgICAgY2xvc2VQb3B1cChtb2RhbCk7XG4gICAgfVxuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwibmFtZSIsImxpbmsiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VJY29uIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJyZW1vdmUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJnZXRWaWV3Iiwibm9kZSIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRJbWFnZUVsIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWwiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsIiwiZXJyb3JNZXNzYWdlRWwiLCJpZCIsImFkZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxzIiwiZGlzYWJsZWQiLCJpbnB1dExpc3QiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZUVkaXRDbG9zZSIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRWRpdEZvcm0iLCJhZGROZXdDYXJkTW9kYWwiLCJhZGROZXdDYXJkQ2xvc2VCdXR0b24iLCJjYXJkTGlzdEVsIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhZGROZXdDYXJkQnV0dG9uIiwiYWRkTmV3Q2FyZEZvcm0iLCJjYXJkVGl0bGVJbnB1dCIsImNhcmRVcmxJbnB1dCIsInByZXZpZXdJbWFnZU1vZGFsIiwicHJldmlld0ltYWdlQ2xvc2UiLCJwcmV2aWV3SW1hZ2VFbGVtZW50IiwicHJldmlld0ltYWdlVGV4dCIsIm9wZW5Qb3B1cCIsIm1vZGFsIiwiY2xvc2VCeUVzY2FwZSIsImNsb3NlUG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwib3BlbmVkUG9wdXAiLCJtb2RhbHMiLCJjcmVhdGVDYXJkIiwiY2FyZERhdGEiLCJ2YWx1ZSIsImNhcmROb2RlIiwicHJlcGVuZCIsInJlbmRlckNhcmQiLCJyZXNldCIsImFkZEZvcm1WYWxpZGF0b3IiLCJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJlZGl0Rm9ybVZhbGlkYXRvciIsInRhcmdldCIsIm1hdGNoZXMiXSwic291cmNlUm9vdCI6IiJ9